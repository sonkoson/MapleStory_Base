
import os

replacements = {
    # Fix corrupted Thai strings
    "ชื่͵ัวลФร": "ชื่อตัวละคร",
    "จӹǹ": "จำนวน",
    "ฟื鹿ูเลืʹ": "ฟื้นฟูเลือด",
    "มҹҢͧคس": "มานาของคุณ",
    "เปลี่¹อҪվขͧคس": "เปลี่ยนอาชีพของคุณ",
    "เพิ่มเลเวŨนถ֧เป้าหมาย": "เพิ่มเลเวลจนถึงเป้าหมาย",
    "เʡไอเทม": "เสกไอเทม",
    "ดรͻไอเทม": "ดรอปไอเทม",
    "เʡเงԹ": "เสกเงิน",
    "ตั駤่ҁ": "ตั้งค่า",
    "ตั駤่Ҫื่อเสี§": "ตั้งค่าชื่อเสียง",
    "เปԴร้ҹค้า": "เปิดร้านค้า",
    "ให้ᤪกѺผู้เล่น": "ให้แคชกับผู้เล่น",
    "โหŴʤรԻต์ใหม่จҡดิʡ์": "โหลดสคริปต์ใหม่จากดิสก์",
    "เลเวลส٧สشและรѺขͧเริ่มต้น": "เลเวลสูงสุดและรับของเริ่มต้น",
    "หรือคسไม่มีสԷธิ์ใช้งาน": "หรือคุณไม่มีสิทธิ์ใช้งาน",
    "กิจกรรมรายวันหยشแล้ǁ": "กิจกรรมรายวันหยุดแล้ว",
    "คسได้รับของขวัญจาก": "คุณได้รับของขวัญจาก",
    "ไม่สามาöย้ายแผนที่ขณеายหรื͵Դเธ ารกิจได้": "ไม่สามารถย้ายแผนที่ขณะตายหรือติดภารกิจได้",
    "รีเซ็ตอันดับวѴความเสียหายแล้ว": "รีเซ็ตอันดับวัดความเสียหายแล้ว",
    "แʴงข้อมูลมอนสเตอร์ในแผนที่": "แสดงข้อมูลมอนสเตอร์ในแผนที่",
    "ตั้งค่ҁHP": "ตั้งค่า HP",
    "กำลังรีโหŴ": "กำลังรีโหลด",
    "เกԴข้อผԴพลҴ": "เกิดข้อผิดพลาด",
    "ไม่พบ NPC ในข้อมูŁWZ": "ไม่พบ NPC ในข้อมูล WZ",
    "เรียก NPC ออกมҷี่ตำแหน่งของคس": "เรียก NPC ออกมาที่ตำแหน่งของคุณ",
    "แʴงข้อมูลพิกѴปัจจุบันของคس": "แสดงข้อมูลพิกัดปัจจุบันของคุณ",
    "คسไม่สามาö": "คุณไม่สามารถ",
    "เพิ่มค่าʶานеԴลบได้": "เพิ่มค่าสถานะติดลบได้",
    "ค่าʶานะเกิน": "ค่าสถานะเกิน",
    "คسมีค่ҁAP": "คุณมีค่า AP",
    "คسมีค่ҁSP": "คุณมีค่า SP",
    "ʶานะ:": "สถานะ:",
    "ปŴล็อคการกรзำแล้ว": "ปลดล็อคการกระทำแล้ว",
    "คำสั่งถูกปԴใช้งาน": "คำสั่งถูกปิดใช้งาน",
    "หน้ҵ่างʶานеัวละคร": "หน้าต่างสถานะตัวละคร",
    "ตรวจสอบʶานะ": "ตรวจสอบสถานะ",
    "แʴงผู้เล่นออนไลน์": "แสดงผู้เล่นออนไลน์",
    "แʴงความช่วยเหลือ": "แสดงความช่วยเหลือ",
    "หยشการวิเคราะห์": "หยุดการวิเคราะห์",
    "ไฟล์นี้มีอยู่แล้ǁโปôเลือกชื่อไฟล์อื่น": "ไฟล์นี้มีอยู่แล้วโปรดเลือกชื่อไฟล์อื่น",
    "โหŴข้อมูŁ": "โหลดข้อมูล",
    "โหมดฝึÖซ้อม": "โหมดฝึกซ้อม",
    "อѻʡิล": "อัพสกิล",
    "คس": "คุณ",
    "รѺ": "รับ",
    "โหŴ": "โหลด",
    "หรื͵": "หรือ",
    "ไม辺": "ไม่มี",
    "ผู้เล蹁": "ผู้เล่น",
    "ขณะอͿไŹ์": "ขณะออฟไลน์",
    "ᤪ": "แคช",
    "ʴ": "แสดง",
    "ö": "รถ", # Warning: check context. 'สามาö' -> 'สามารถ'
    "สามาö": "สามารถ",
    "แมพ": "แผนที่", # If needed
    
    # Contextual fixes for partials
    "เพิ่มค่ҁ": "เพิ่มค่า",
    "ชื่อเสี§": "ชื่อเสียง",
    "เปԴ": "เปิด",
    "ไม่พบคำสั่ง": "ไม่พบคำสั่ง",
    "หรือคس": "หรือคุณ",
    
    # Magnus Field Fixes
    "매그너스가 구와르를 ์ œ어하는 힘이 약화 되었습니다. 구와르의 기운이 더욱 강해집니다.": "พลังของ Magnus ที่ควบคุม Guwaru อ่อนลงแล้ว พลังของ Guwaru จึงแข็งแกร่งขึ้น",
    "매그너스가 구와르를 제어하는 힘이 약화 되었습니다. 구와르의 기운이 더욱 강해집니다.": "พลังของ Magnus ที่ควบคุม Guwaru อ่อนลงแล้ว พลังของ Guwaru จึงแข็งแกร่งขึ้น",
    
    # Fix for DonationRequest mojibake (Specific Lines)
    '"เนŒย‹ยย เนŒเธ’เธ  เนŒย‹ยœเนŠเธ ย„"': '"Character Name"',
    '"เนŠเธ“ย„เนŒยย โ€ข ID"': '"Account ID"',
    '"เนŒเธšย เน‹เธ†เธ เน ย„เธ  เนŒย เธ”เน‹เธ†ย„"': '"Date/Time"',
    '"เนŒยžโ€ฆเนŠเธ˜ยˆเนŒยžย เน‹เธŠโ€ฆ"': '"Amount"', 
    '"เนŒย‹ยย เนŒเธ’เธ  เน ย เธŒเนŒย เธ˜เน ยŠเธ˜"': '"Status"',
    '"เนŒยœยย เน ย˜โ€ข"': '"Type"',
    '"เนŒยƒย เน ยƒยœ"': '"Note"',

    # Additional DonationRequest Button Texts (heuristic based on context)
    '"เน ย เธŒเนŒย เธ˜เน ยŠเธ˜ เนŒเธ–เธ‰เนŒยย ย„ เนŒย‹ยย เนŒเธ’เธ  เน‹ย‚เธ”เนŒโ€”เธ  -"': '"Search Character Name -"',
    '"เนŒยƒยˆเน‹เธ ยœเนŠเธ“ยย เนŒเธ™เธˆ"': '"Search"',
    # ..."เน‹ย‚ย˜เน‹ยˆโ€ เนŠเธ“ยย เน‹โ€ โ€ข"... Font Name? Leave it or fix if font.
    '"เนŒย„ยย เน ยƒย เน‹ย ยœ เน‹ยŒโ‚ฌเนŒยƒย "': '"Enter Name"',
    '"เนŒเธ–เธ‰เนŒยย ย„ เนŒย™ย„เน‹เธƒยŒ"': '"Refuse"',
    '"เน‹เธ เธ˜เนŒเธ’ย˜เน‹เธ†เธŒ"': '"Pending"',
    '"เนŒยžโ€ฆเนŠเธ˜ยˆ เน‹ยˆย„เน‹ย เธ "': '"Confirm"',
    # Status replacements
    '"เนŒเธ’ย˜เน‹เธ†เธŒเนŒย™ย„เน‹เธƒยŒ"': '"Rejected"',
    '"เนŒยžโ€ฆเนŠเธ˜ยˆเน‹ยˆย„เน‹ย เธ "': '"Approved"',
    
    # Types
    '"เนŒย เธœเน‹เธ ย˜"': '"Bank Transfer"',
    '"เนŒย เธ”เน‹เธ’เธ„เน ยŠเธ˜"': '"Credit Card"',
    '"เนŒเธ”ยˆเนŒย‹เธŒเนŒยžย เน ยŒเธˆเน ย‚เธ„เนŒเธ‡โ‚ฌ"': '"TrueMoney Wallet"',
     # ... There are many types, will map general known ones if possible.
     # Or just replace known corrupted strings with logical English/Thai equivalents.
     
     # WarpCommands
     "เกԴข้อผԴพลҴบางอย่าง": "เกิดข้อผิดพลาดบางอย่าง",
     "ไม่สามาöวาร์ปผู้เล่นซ้ำๆ ได้": "ไม่สามารถวาร์ปผู้เล่นซ้ำๆ ได้",
     "ไม่สามาöวาร์ปผู้เล่นได้": "ไม่สามารถวาร์ปผู้เล่นได้",
     "คسถูกเรียกตัวโด GM": "คุณถูกเรียกตัวโดย GM",
     "เรียกผู้เล่นมาหาคس": "เรียกผู้เล่นมาหาคุณ",
     
     # RoyalCommand
     "ตั้งค่ҁKeyValue": "ตั้งค่า KeyValue",
     
     # SpawnMonster
     "พลังแห่งความม״ทำให้": "พลังแห่งความมืดทำให้",
     "ถูกจำกѴ": "ถูกจำกัด",
     "เรียกมอนสเตอร์ด้ǁID": "เรียกมอนสเตอร์ด้วย ID",
     
     # Reloading
     "ใหม่เสร็จสิ้น": "ใหม่เสร็จสิ้น", # Context "โหŴ...เสร็จสิ้น"
     "โหŴ": "โหลด",
}

def process_file(file_path):
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()
            
        original_content = content
        
        for bad, good in replacements.items():
            if bad in content:
                content = content.replace(bad, good)
                
        if content != original_content:
            with open(file_path, 'w', encoding='utf-8') as f:
                f.write(content)
            print(f"Fixed {file_path}")
            
    except Exception as e:
        print(f"Error processing {file_path}: {e}")

def run_fix(root_dir):
    for root, dirs, files in os.walk(root_dir):
        for file in files:
            if file.endswith(".java"):
                process_file(os.path.join(root, file))

if __name__ == "__main__":
    run_fix("src")
    run_fix("data/scripts")
